CREATE TABLE "OrganizationPayment" (
  "id" SERIAL PRIMARY KEY,
  "organization_id" INT,
  "payment_method" VARCHAR,
  "payment_token" VARCHAR,
  "expires_at" TIMESTAMP,
  "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE "UserPayment" (
  "id" SERIAL PRIMARY KEY,
  "user_id" INT,
  "payment_method" VARCHAR,
  "payment_token" VARCHAR,
  "expires_at" TIMESTAMP,
  "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE "Organization" (
  "id" SERIAL PRIMARY KEY,
  "name" VARCHAR,
  "phone" VARCHAR,
  "features" VARCHAR,
  "payment_id" INT
);

CREATE TABLE "OrganizationOwner" (
  "organization_id" INT,
  "user_id" INT
);

CREATE TABLE "OrganizationAdmin" (
  "organization_id" INT,
  "user_id" INT
);

CREATE TABLE "OrganizationUser" (
  "organization_id" INT,
  "user_id" INT
);

CREATE TABLE "User" (
  "id" SERIAL PRIMARY KEY,
  "first_name" VARCHAR,
  "last_name" VARCHAR,
  "email" VARCHAR,
  "password" VARCHAR,
  "phone" VARCHAR,
  "organization_id" INT,
  "payment_id" INT
);

CREATE TABLE "Patent" (
  "id" SERIAL PRIMARY KEY,
  "pqai_id" VARCHAR,
  "name" VARCHAR,
  "folder_id" INT,
  "description" VARCHAR,
  "organization_id" INT,
  "googlePatentsLink" VARCHAR
);

CREATE TABLE "PatentReadPermission" (
  "patent_id" INT,
  "user_id" INT
);

CREATE TABLE "PatentWritePermission" (
  "patent_id" INT,
  "user_id" INT
);

CREATE TABLE "Folder" (
  "id" SERIAL PRIMARY KEY,
  "name" VARCHAR,
  "description" VARCHAR,
  "organization_id" INT,
  "parent_folder_id" INT
);

CREATE TABLE "FolderUser" (
  "folder_id" INT,
  "user_id" INT
);

CREATE TABLE "FolderPatent" (
  "folder_id" INT,
  "patent_id" INT
);

CREATE TABLE "FolderReadPermission" (
  "folder_id" INT,
  "user_id" INT
);

CREATE TABLE "FolderWritePermission" (
  "folder_id" INT,
  "user_id" INT
);

CREATE TABLE "Search" (
  "id" SERIAL PRIMARY KEY,
  "user_id" INT,
  "query" VARCHAR,
  "time" TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE "Metric" (
  "id" SERIAL PRIMARY KEY,
  "search_id" INT,
  "patent_id" INT,
  "sentence" VARCHAR,
  "match_percentage" INT
);

CREATE TABLE "UserSearchCount" (
  "user_id" INT PRIMARY KEY,
  "search_count" INT
);

CREATE TABLE "SearchAnalytics" (
  "id" SERIAL PRIMARY KEY,
  "user_id" INT,
  "search_id" INT,
  "search_time" TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Adding foreign key constraints
ALTER TABLE "OrganizationPayment" ADD FOREIGN KEY ("organization_id") REFERENCES "Organization" ("id");

ALTER TABLE "UserPayment" ADD FOREIGN KEY ("user_id") REFERENCES "User" ("id");

ALTER TABLE "Organization" ADD FOREIGN KEY ("payment_id") REFERENCES "OrganizationPayment" ("id");

ALTER TABLE "OrganizationOwner" ADD FOREIGN KEY ("organization_id") REFERENCES "Organization" ("id");

ALTER TABLE "OrganizationOwner" ADD FOREIGN KEY ("user_id") REFERENCES "User" ("id");

ALTER TABLE "OrganizationAdmin" ADD FOREIGN KEY ("organization_id") REFERENCES "Organization" ("id");

ALTER TABLE "OrganizationAdmin" ADD FOREIGN KEY ("user_id") REFERENCES "User" ("id");

ALTER TABLE "OrganizationUser" ADD FOREIGN KEY ("organization_id") REFERENCES "Organization" ("id");

ALTER TABLE "OrganizationUser" ADD FOREIGN KEY ("user_id") REFERENCES "User" ("id");

ALTER TABLE "User" ADD FOREIGN KEY ("organization_id") REFERENCES "Organization" ("id");

ALTER TABLE "User" ADD FOREIGN KEY ("payment_id") REFERENCES "UserPayment" ("id");

ALTER TABLE "Patent" ADD FOREIGN KEY ("folder_id") REFERENCES "Folder" ("id");

ALTER TABLE "Patent" ADD FOREIGN KEY ("organization_id") REFERENCES "Organization" ("id");

ALTER TABLE "PatentReadPermission" ADD FOREIGN KEY ("patent_id") REFERENCES "Patent" ("id");

ALTER TABLE "PatentReadPermission" ADD FOREIGN KEY ("user_id") REFERENCES "User" ("id");

ALTER TABLE "PatentWritePermission" ADD FOREIGN KEY ("patent_id") REFERENCES "Patent" ("id");

ALTER TABLE "PatentWritePermission" ADD FOREIGN KEY ("user_id") REFERENCES "User" ("id");

ALTER TABLE "Folder" ADD FOREIGN KEY ("organization_id") REFERENCES "Organization" ("id");

ALTER TABLE "Folder" ADD FOREIGN KEY ("parent_folder_id") REFERENCES "Folder" ("id");

ALTER TABLE "FolderUser" ADD FOREIGN KEY ("folder_id") REFERENCES "Folder" ("id");

ALTER TABLE "FolderUser" ADD FOREIGN KEY ("user_id") REFERENCES "User" ("id");

ALTER TABLE "FolderPatent" ADD FOREIGN KEY ("folder_id") REFERENCES "Folder" ("id");

ALTER TABLE "FolderPatent" ADD FOREIGN KEY ("patent_id") REFERENCES "Patent" ("id");

ALTER TABLE "FolderReadPermission" ADD FOREIGN KEY ("folder_id") REFERENCES "Folder" ("id");

ALTER TABLE "FolderReadPermission" ADD FOREIGN KEY ("user_id") REFERENCES "User" ("id");

ALTER TABLE "FolderWritePermission" ADD FOREIGN KEY ("folder_id") REFERENCES "Folder" ("id");

ALTER TABLE "FolderWritePermission" ADD FOREIGN KEY ("user_id") REFERENCES "User" ("id");

ALTER TABLE "Search" ADD FOREIGN KEY ("user_id") REFERENCES "User" ("id");

ALTER TABLE "Metric" ADD FOREIGN KEY ("search_id") REFERENCES "Search" ("id");

ALTER TABLE "Metric" ADD FOREIGN KEY ("patent_id") REFERENCES "Patent" ("id");

ALTER TABLE "UserSearchCount" ADD FOREIGN KEY ("user_id") REFERENCES "User" ("id");

ALTER TABLE "SearchAnalytics" ADD FOREIGN KEY ("user_id") REFERENCES "User" ("id");

ALTER TABLE "SearchAnalytics" ADD FOREIGN KEY ("search_id") REFERENCES "Search" ("id");
